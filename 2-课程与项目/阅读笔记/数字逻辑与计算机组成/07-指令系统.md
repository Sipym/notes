# 指令系统概述
**指令集体系架构(ISA)**: 是一台计算机的抽象模型，是<font color=purple>计算机的"功能规范说明书"</font>.简称为`指令系统`  
   - `从硬件设计角度`: ISA规定了一台计算机需要具备的基本功能，软件将使用这些功能来对计算机的行为进行控制  
   - `从软件编程角度`: ISA定义了系统程序员为了对计算机硬件进行编程而需要了解的所有内容[^1]  

**指令系统的重要性**: 位于软件和硬件之间的交界面，是`构成程序的基本元素`，也是`硬件设计的依据`。他衡量硬件的功能，<font color=purple>反映硬件对软件支持的程度</font>.直接决定计算机的性能和成本  


:star:**<font color=purple>一条指令必须明显或隐含包含的信息</font>**:
- `操作码`: <u>指定操作类型</u>，如移位、加、减、乘、除、传送等  
- `源操作数或其地址`: <u>指出一个或多个源操作数或其所在的地址</u>，可以是主(虚)存地址、寄存器编号或I/O端口，也可以在指令中直接给出一个立即操作数  
- `结果的地址`: <u>结果所存放的地址</u>。可以是主(虚)存地址、寄存器编号或I/O端口  
- `下条指令地址`: <u>下条指令所存放的主(虚)存地址</u>.
   - <font color=purple>指令按顺序执行时</font>，不在指令中明显给出，<font color=purple>地址隐含在程序计数器(PC)中</font>  
   - 当遇到<font color=purple>转移指令而不按顺序执行</font>时，这时<font color=purple>由指令给出地址</font>  

**指令**: 一条指令由`一个操作码`和`几个地址码`构成  
**指令分类**: 根据指令 `显示给出的地址码`的个数,分为`三地址指令`、`二地址指令`、`单地址指令`和`零地址指令`  

**指令格式设计原则**:  
- 操作码的编码必须有唯一的解释  
- 指令应尽量短。  
- 指令长度应是字节的整数倍  

# 指令系统设计
## 操作数和寻址方式
**操作数**: 是指令处理的对象  
**操作数类型**:  
   - `无符号整数`。用于表示指针或主(虚)存地址  
   - `带符号数值数据`，包括带符号整数(用二进制补码表示)和浮点数(用IEEE 754标准表示)。
   - `位、位串、字符和字符串`。位和位串数据一般用来<font color=purple>表示一些标志、控制和状态等信息</font>;字符和字符串表示文本、流式文件等信息  
   - `逻辑(布尔)数据`。表示逻辑值  

**有效地址**: 通常把指令中给出的`操作数所在存储单元的地址`称为有效地址  

**寻址方式**: 指令给出的操作数或操作数地址的方式  
1. `立即寻址`: 在指令中直接给出操作数本身，这种操作数称为立即数  
2. `直接寻址`: 指令中给出的地址码是操作数的有效地址   
3. `间接寻址`: 指令中给出的地址码是存放操作数有效地址的存储单元的地址  
![img](img/单级间接地址.png '图1 单级间接地址 :size=100%')  
4. `寄存器(直接)寻址`: 指令中给出的地址码是<font color=purple>操作数所在的寄存器编号</font>,操作数在寄存器中  
   - 寄存器寻址方式的指令较短(寄存器数量远小于存储单元数)  
   - 操作数已在CPU中，不用访存，因此指令执行速度快  
5. `寄存器间接寻址`: 指令中给出的地址码是一个寄存器编号，寄存器中存放的是操作数的有效地址  
6. `变址寻址`(详细看书): 主要用于对线性标之类的数组元素进行方便的访问  
7. `相对寻址`: 指令操作数的有效地址或<font color=purple>转移目标地址</font>位于该指令所在位置的前、后某个固定的位置上，则该操作数或转移目标可用相对寻址方式  
   - 使用: 指令中的地址码片段A给出一个偏移量，基准地址由PC隐含给出。所以<font color=purple>操作数有效地址或转移目标地址为$EA = (PC) + A$</font>  
8. `基址寻址`: 指令中地址码字段A给出一个偏移量，基准地址可以明显或隐含的由基址寄存器B给出。<font color=purple>操作数有效地址$EA = (B) + A$</font>  


[^1]: ISA定义的所有内容，包括指令系统中所包含的`每一条指令的功能`、`指令格式`、`指令所处理的数据类型及格式`、`寻址方式`、`可访问的地址空间`、`通用寄存器个数和位数`、`控制寄存器的定义`、`I/O空间的编址方式`、`中断处理机制`、`机器特权模式`和`状态的定义与切换`、`输入/输出组织和数据传送方式`、`存储保护方式`等  
