# 第四章 被控过程的数学模型<font color=red>(重点)</font>
## 过程建模的基本概念
### 被控过程的数学模型及其作用
**被控过程的数学模型概念**: 指过程的`输入变量`与`输出变量`之间的<font color=purple>定量关系的描述</font>  
   - > **输出变量**:  也称`被控变量`  
   - > **输入变量**: 作用于过程的<font color=green>干扰作用</font>和<font color=green>控制作用</font>  

![img](img/干扰输入_控制输入与输出之间的关系.png '图1 干扰输入,控制输入与输出之间的关系 :size=70%')  
> `通道`: 过程的输入变量至输出变量的信号联系  
> `控制通道`: 控制作用至输出变量的信号联系  
> `干扰通道`: 干扰作用至输出变量的信号联系  
> `过程的输出`: 控制通道与干扰通道的输出之和  


**数学模型分类**: `静态数学模型`，`动态数学模型`  
   - > `静态数学模型`: 描述的是<font color=blue>过程在稳态时</font>的，输入输出变量之间的关系  
   - > `动态数学模型`: 描述的是过程在<font color=blue>输入量改变后</font>，输出量的变化情况  

### 被控过程的特性(<font color=blue>可能填空</font>)
**分类**: `有自衡特性`与`无自衡特性`、 `单容特性`与`多容特性` 、`振荡`与`非振荡特性`等  

####  有自衡特性和无自衡特性
**有自衡特性**: `原处于平衡状态`的过程，`受到干扰时`，输出量<font color=blue>在无人或无控制装置的干预下</font>，能<font color=blue>自动回复到原来或新的平衡状态</font>  

![img](img/有自衡特性的过程及其响应曲线.png '图2 有自衡特性的过程及其响应曲线 :size=60%')  
**有自衡特性其传递函数的典型形式**:  
`一阶惯性环节`: $G(s) = \frac{K}{Ts+1}$  
`二阶惯性环节`: $G(s) = \frac{K}{(T_1s+1)(T_2s+1)}$  
`一阶惯性+纯滞后环节`: $G(s) = \frac{Ke^{-\tau s}}{(Ts+1)}$  
`二阶惯性+纯滞后环节`: $G(s) = \frac{Ke^{-\tau s}}{(T_1s+1)(T_2s+1)}$  

![img](img/无自衡特性其传递函数的典型形式.png '图3 无自衡特性其传递函数的典型形式 :size=60%')  
**无自衡特性其传递函数的典型形式**:
`一阶环节`: $G(s) = \frac{1}{Ts}$  
`二阶环节`: $G(s) = \frac{1}{(T_1s)(T_2s+1)}$  
`一阶+纯滞后环节`: $G(s) = \frac{1}{Ts}e^{-\tau s}$  
`二阶+纯滞后环节`: $G(s) = \frac{1}{T_1s(T_2s+1)}e^{-\tau s}$  

#### 振荡和非振荡过程的特性
![img](img/阶跃书信作用下过程的输出响应曲线.png '图4 阶跃输入作用下过程的输出响应曲线 :size=100%')  
a) `发散振荡过程`; b) `等幅振荡过程`; c) `衰减振荡过程`; d) `非振荡发散过程`;  e) `非振荡衰减过程`  

#### 具有反向特性的过程
**具有反向特性的被控过程**: 对过程施加一阶跃输入信号，若`在开始一段时间内`，过程的<font color=purple>输出先降后升或先升后降</font>

### 过程建模方式
#### 机理演绎法(又称解析法)
**原理**: 根据被控过程的内部机理，运用已知的<font color=red>静态或动态平衡关系</font>，用数学解析的方法求取被控过程的数学模型  

:star:**<font color=red>动态平衡关系</font>**: `单位时间内进入被控过程的物料或能量` 与 `单位时间内流出被控过程的物料或能量`<font color=blue>之差</font>,等于<font color=purple>被控过程内物料或能量储存量的<u>变化率</u></font>  



#### 试验辨识法
**思路**: 先`给被控过程人为地施加一个输入`作用,记录过程的输出变化量，`得到一系列试验数据或曲线`，根据数据<font color=purple>确定其模型的结构与模型的参数</font>  

#### 混合法
机理演绎法与试验辩识法的相互交替使用的一种方法

## 解析法建立过程的数学模型<font color=red>(重点)</font> 
### 解析法建模一般步骤
1. 明确过程的输入输出变量，和其他中间变量  
2. 以物料或能量的<font color=red>静态/动态平衡方程为基本依据</font>，<font color=purple>列写静态/动态方程</font>  
3. 消除中间变量，<font color=purple>求取输入、输出变量的关系方程</font>  
4. 简化成`控制要求`的格式，如微分方程和传递函数  

### 单容过程的解析法建模
![img](img/单容过程.png '图 单容过程 :size=70%')  

#### 例子1:有自衡能力的单容对象
- 第一步: 根据<font color=red>动态物料平衡建立方程</font>: $q_1 - q_2 = A\frac{dh}{dt}$  
   - >**写成增量方程**: $\Delta q_1 - \Delta q_2 = A\frac{d\Delta h}{dt}$  
- 第二步: 根据<font color=red>静态物料平衡建立方程</font>: $q_{10} = q_{20}$  
- 第三步: 根据`压力关系`,$\Delta q_2 = \frac{\Delta h}{R_2}$  
   - >$R_2$: <font color=purple>阀门2处的液阻</font>, 即流量增加$1m^2/s$时的液位升高量  
- 第四步: 得<font color=blue>微分方程</font>:$R_2A\frac{d\Delta h}{dt} + \Delta h = R_2 \Delta q_1$  
- 第五步: 得<font color=blue>传递函数</font>形式: $G(s) = \frac{H(s)}{Q_1(s)} = \frac{R_2}{R_2As + 1} = \frac{K}{Ts+1}$  

> :bulb: <font color=green>相关参数介绍</font>  
>> $R_2$: 阀门2的液阻  
>> $T = R_2C$: 被控过程的时间常数  
>> $K = R_2$: 被控过程的放大系数  
>> $C = A$: 被控过程的容量系数,即引起单位被控量变化时被控过程存储量变化的大小  

##### 绘画过程框图步骤(<font color=red>重点</font>)
1. 写出微分方程表达式  
2. 得到输出变量与输入变量的传递函数表达式  
3. 得到输出变量与其他变量的传递函数表达式  
4. 即可画出过程框图  


#### 例子2:具有纯滞后的单容对象(有时写题，需要同时考虑有滞后和无滞后)
**不同点**: 即$q_0$到$q_1$需要通过一个管道，其间耗时$\tau_0 = \frac{Q}{l}$  
   - > 管道长度l  
   - > 管道流量Q恒定  

有:$R_2A\frac{d\Delta h}{dt} + \Delta h = R_2$<font color=red>$\Delta q_0(t-\tau _0)$ </font>   
有:$G(s) = \frac{K_0}{T_0s+1}e^{-\tau_0s}$  

#### 例子3:无自衡能力的单容对象
**不同点**:<font color=purple>$q_2$的值是常数</font>，不再与$\Delta h,R_2$(液位，液阻)相关  

> `传递函数`: $G(s) = \frac{1}{Ts}$  

#### 不同系统的容量系数C意义
**液位控制系统**: 容量系数C(储水量系数)为`水箱截面积A`  
**温度控制系统**: 容量系数C(热水中热量系数) 为`热水质量与比热的乘积`$Gc_p$  
**电压控制系统**: 容量系数C(电容系数)为`电容量C`  

### 多容过程的解析法建模(应该不考)
- 第一步: 根据<font color=red>动态物料平衡建立方程</font>
   - > **写成增量方程**  
- 第二步: 根据<font color=red>静态物料平衡建立方程</font>
- 第三步: 根据`压力关系`,$\Delta q_2 = \frac{\Delta h}{R_2}$,...  
   - <font color=red>有几个阀写几个公式</font>  
- 第四步: 得微分方程或传递函数  



## 试验法建立过程的数学模型
### 响应曲线法(<font color=red>重中之重</font>)  
**原理**:通过`操作调节阀`,使被控过程的`控制输入`产生<font color=purple><u>阶跃变化</u>或<u>方波变化</u></font>,得到被控量随时间变化的响应曲线或输出数据，在根据`输入-输出数据`，求取过程的`输入-输出之间的数学关系`。  

#### 阶跃响应曲线法
##### 阶跃响应曲线
![img](img/单容过程的阶跃响应曲线.png '图5 阶跃响应曲线 :size=50%')  
:star:**<font color=blue>阶跃响应输入输出关系</font>**:$y(t) = Kx_0(1-e^{\frac{t}{T}})$  

:star:**<font color=red>注意事项</font>**:  
   - 试验一般是在过程正常工作状态下进行，即<font color=purple>在原来输入的基础上叠加了$x_0$的阶跃变化量</font>  
   - `上式的输出表达式`应是`原输出值基础上`的<font color=red>增量表达式</font>  
   - 用`输出测量数据`作阶跃响应曲线时，应<font color=red>减去原来的正常输出值</font>  

**时间常数T的物理意义**: 
   - 受到阶跃输入后，输出到<font color=purple>新的稳态值的$63.2\%$所需的时间</font>  
   - 反映了对象输出对输入的响应速度  
   - 反映了<font color=red>过渡过程时间($3T$)</font>,可以近似认为动态过程结束   


##### 注意事项
1. 测试前，`被控过程`应处于<font color=purple>相对稳定</font>的工作状态  
2. 相同条件下，重复多做几次试验。<font color=purple>减少随机干扰的影响</font>  
3. 分别做正、反方向的阶跃输入信号，并比较两次试验结果，以<font color=purple>衡量过程的非线性程度</font>  
4. 一次试验后，应将被控过程恢复到原来的工况并<font color=purple>稳定后，在做第二次</font>  
5. <font color=purple>输入的阶跃幅度不能过大,一面对生产的正常进行产生不利影响。不能过小，以防其他干扰影响的比重相对较大而影响结果</font>  
   - > 一般<font color=red>取正常输入信号最大赋值的$5\%$~$10\%$之间，常取$10\%$</font>  

##### 模型结构的确定
|  --      |    大多数过程       |  无自衡特性过程   	|
| ------------- |-------------  | ------- |
|    **一阶惯性**    |     $G(s) = \frac{K_0}{T_0s+1}$         |  $G(s) = \frac{K_0}{T_0s}$      |
|    **一阶惯性+纯滞后**    | $G(s) = \frac{K_0}{T_0s+1}e^{-\tau s}$             | $G(s) = \frac{K_0}{T_0s}e^{-\tau s}$        |
|    **二阶惯性**    |  $\frac{K_0}{(T_1s+1)(T_2s+1)}$            |  $\frac{K_0}{(T_1s)(T_2s+1)}$      |
|    **二阶惯性+纯滞后**    |  $\frac{K_0}{(T_1s+1)(T_2s+1)}e^{-\tau s}$            |  $\frac{K_0}{(T_1s)(T_2s+1)}e^{-\tau s}$      |


##### 模型参数的确定

###### 情形1:确定一阶惯性环节的参数
> <font color=purple>选定该模型的情形</font>: 在t=0时曲线斜率最大，随后斜率逐渐减小，上升到稳态值时为0。则可用该模型  

![img](img/一阶无时延环节的阶跃响应曲线.png '图6 一阶无时延环节的阶跃响应曲线 :size=30%')  

**输入、输出关系**:<font color=red>$y(t) = K_0x_0(1-e^{-\frac{t}{T_0}})$</font>  

**模型参数**: $K_0,T_0$  

**方法1**:(图像法),参考上图。作一切线，即可的$K_0,T_0$  
**方法2**:(计算法)  
1. 由$y(\infty ) = K_0x_0$得$K_0$  
2. $$\begin{cases}
y(t_1 = \frac{T_0}{2}) = 39\%y(\infty) \\
y(t_2 = T_0) = 63\%y(\infty) \\
y(t_3 = 2T_0) = 86.4\%y(\infty)
\end{cases}$$  
3. 由2可计算出三个$T_0$,求其平均值  

---
###### 情形2:确定一阶惯性+纯之后环节的参数(<font color=red>必考</font>)
![img](img/一阶时延环节的阶跃响应曲线.png '图7 一阶时延环节的阶跃响应曲线 :size=50%')
![img](img/一阶时延环节标幺值阶跃响应曲线.png '图8 一阶时延环节标幺值阶跃响应曲线 :size=50%')  

> <font color=purple>选定该模型的情形</font>: 在t=0时曲线斜率为0，随后斜率逐渐增大，到达某点后斜率又逐渐减小,<font color=blue>呈S形状</font>。则可用该模型  

**模型参数**: $K_0,T_0,\tau$   

**方法**(两点法):  
1. 将y(t)转换呈标幺值$y_0(t)$, <font color=blue>$y_0(t) = \frac{y(t)}{y(\infty)}$</font>  
   - > <font color=red>在$(0,\tau)$范围内,$\frac{y(t)}{y(\infty)}$可近似为0 </font> 
2. $$y_0(t) = \begin{cases} 
0   &t < \tau _0 \\
1 - e^{-\frac{t-\tau_0}{T_0}} & t \ge \tau_0
\end{cases}$$  

3. 任取两个点，代入即可即可得<font color=red>$T_0, \tau$</font>  


---
###### 情形3:确定二阶惯性环节的参数
![img](img/二阶惯性环节的阶跃响应曲线.png '图9 二阶惯性环节的阶跃响应曲线 :size=50%')
**模型参数**: $K_0,T_1,T_2$  
**方法**:(两点法)
1.  已知<font color=blue>$y(t) = K_0x_0(1-\frac{T_1}{T_1-T_2}e^{-\frac{t}{T_1}}+\frac{T_2}{T_1-T_2}e^{-\frac{t}{T_2}})$</font>  
2. 有<font color=blue>$y(\infty) = K_0x_0$</font>,可得$K_0$  
3. 任取两点$t_1,t_2$代入表达式
   - ><font color=green>通常取y(t)为稳态值的$40\%,80\%$来计算</font>  
4. <font color=red>可得近似解</font>:
<font color=red>$$
\begin{array}{lcl}
T_1+T_2        & \approx & \frac{1}{2.16}(t_1+t_2) \\
\frac{T_1T_2}{(T_1+T_2)^2} & \approx & (1.74\frac{t_1}{t_2} - 0.55)
\end{array}
$$</font>  
   - >要求: 满足$0.32<\frac{t_1}{t_2}<0.46$  
---

###### 情形4: <font color=red>确定n阶惯性环节的参数</font>(<font color=red>重点</font>)
**传递函数**:$G(s) = \frac{K_0}{(T_0s+1)^n}$  
**模型参数**:$K_0,T_0$  
**方法**： (以二阶为例) 
1. <font color=red>假设$y(\infty) = K_0x_0$</font>  
2. $$\begin{cases}
y(t_1) = 0.4y(\infty) \\
y(t_2) = 0.8y(\infty)
\end{cases}$$  
3. 根据给定数据画图，可确定$t_1,t_2$  
4. 判断$0.32<\frac{t_1}{t_2}<0.46$  
3. <font color=red>$T_0 = \frac{t_1 + t_2}{2.16*2}$</font>  

---

###### 情形5:确定二阶时延环节的参数
![img](img/二阶惯性加纯滞后环节的阶跃响应曲线.png '图10 二阶惯性+纯滞后环节的阶跃响应曲线 :size=50%')  

**模型参数**:$K_0,T_0,T_1,\tau$  

省略(<font color=red>我认为不考</font>)  

---

###### 情形6:一阶无自衡环节参数
![img](img/一阶无自衡环节.png '图 一阶无自衡环节 :size=50%')  

---

#### 方波响应曲线法(重点)
> **背景**: 有些工艺对象不允许长时间施加较大幅度的扰动 

**方波响应**: 在`正常输入的基础上`，施加<font color=purple>脉宽为$\Delta t$的方波脉冲</font>，得到的响应曲线叫"方波响应"  
![img](img/方波响应响应特性.png '图11 方波响应响应特性 :size=70%')  


**原理**: <font color=red>两个大小相同的阶跃信号的代数和</font>(一个正，一个负)  
![img](img/方波响应两个阶跃信号的代数和.png '图12 方波响应:两个阶跃信号的代数和 :size=70%')  
![img](img/由方波响应确定阶跃响应.png '图13 由方波响应确定阶跃响应 :size=70%')  

$y(t) = y_1(t) + y_2(t) = $<font color=red>$y_1(t) - y_1(t-t_0)$</font>  

**方法**:  
1. <font color=red>转换成阶跃响应</font>:**$y_1(t) = y(t) + y_1(t-t_0)$**    
2. 得到$y_1(t)$的输入输出数据  
3. 根据数据画出$y(t),y_1(t)$曲线  
   - ><font color=green>$y_1(t)$是阶跃响应曲线</font>  
4. 根据`阶跃响应图像形状`<font color=purple>选择模型</font>  
5. 参照前面求得模型参数  


